{% extends 'base.html' %}
{% load static %}

{% block title %}{{ site_settings.site_title|default:'Cyblime-Cycling' }}{% endblock %}

{% block extra_css %}
<style>
    /* CYBLIME Slideshow Styles */
    .cyblime-slideshow {
        position: relative;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        opacity: 0;
        transition: opacity 2s ease-in-out;
        z-index: 1;
    }
    
    .slide.active {
        opacity: 0.7;
    }
    
    .slide-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(0,0,0,0.6), rgba(0,150,136,0.4));
        z-index: 2;
    }
    
    .cyblime-title-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        z-index: 3;
        color: white;
    }
    
    .cyblime-letters {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    
    .letter {
        font-size: 8rem;
        font-weight: 900;
        margin: 0 5px;
        opacity: 0;
        transform: translateY(50px) rotateX(45deg);
        animation: letterDrop 0.8s ease-out forwards;
        text-shadow: 0 10px 20px rgba(0,0,0,0.5);
        background: linear-gradient(45deg, #00BCD4, #FF5722);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .letter:nth-child(1) { animation-delay: 0.1s; }
    .letter:nth-child(2) { animation-delay: 0.2s; }
    .letter:nth-child(3) { animation-delay: 0.3s; }
    .letter:nth-child(4) { animation-delay: 0.4s; }
    .letter:nth-child(5) { animation-delay: 0.5s; }
    .letter:nth-child(6) { animation-delay: 0.6s; }
    .letter:nth-child(7) { animation-delay: 0.7s; }
    
    @keyframes letterDrop {
        to {
            opacity: 1;
            transform: translateY(0) rotateX(0);
        }
    }
    
    .brooklyn-subtitle {
        font-size: 2.5rem;
        font-weight: 600;
        letter-spacing: 0.2em;
        margin-bottom: 10px;
        opacity: 0;
        animation: fadeInUp 1s ease-out 1.5s forwards;
        text-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .cycling-club {
        font-size: 1.5rem;
        font-weight: 300;
        letter-spacing: 0.1em;
        opacity: 0;
        animation: fadeInUp 1s ease-out 2s forwards;
        text-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    @keyframes fadeInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
        from {
            opacity: 0;
            transform: translateY(30px);
        }
    }
    
    .cta-buttons {
        position: absolute;
        bottom: 80px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 3;
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .cta-btn {
        padding: 15px 30px;
        font-size: 1.1rem;
        font-weight: 600;
        border: none;
        border-radius: 50px;
        text-decoration: none;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        opacity: 0;
        animation: fadeInUp 1s ease-out 2.5s forwards;
    }
    
    .cta-join {
        background: linear-gradient(45deg, #00BCD4, #00ACC1);
        color: white;
    }
    
    .cta-events {
        background: linear-gradient(45deg, #FF5722, #FF7043);
        color: white;
    }
    
    .cta-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 35px rgba(0,0,0,0.3);
    }
    
    .slide-indicators {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 3;
    }
    
    .indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255,255,255,0.5);
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .indicator.active {
        background: white;
        transform: scale(1.2);
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
        .letter {
            font-size: 4rem;
            margin: 0 2px;
        }
        
        .brooklyn-subtitle {
            font-size: 1.8rem;
        }
        
        .cycling-club {
            font-size: 1.2rem;
        }
        
        .cta-buttons {
            flex-direction: column;
            align-items: center;
            bottom: 60px;
        }
        
        .cta-btn {
            padding: 12px 25px;
            font-size: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- CYBLIME Slideshow Hero Section -->
<div class="cyblime-slideshow">
    <!-- Background Slides -->
    {% for image in slideshow_images %}
        <div class="slide {% if forloop.first %}active{% endif %}" 
             style="background-image: url('{{ image.image_url }}');">
        </div>
    {% empty %}
        <!-- Default slides if no images in admin -->
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1571068316344-75bc76f77890?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1502744688674-c619d1586c9e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1543662903-72be26c3e872?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');"></div>
    {% endfor %}
    
    <!-- Overlay -->
    <div class="slide-overlay"></div>
    
    <!-- CYBLIME Animated Title -->
    <div class="cyblime-title-container">
        <div class="cyblime-letters">
            <span class="letter">C</span>
            <span class="letter">Y</span>
            <span class="letter">B</span>
            <span class="letter">L</span>
            <span class="letter">I</span>
            <span class="letter">M</span>
            <span class="letter">E</span>
        </div>
        
        <div class="brooklyn-subtitle">
            {{ site_settings.subtitle|default:'BROOKLYN CYBLIME CYCLING CLUB' }}
        </div>
        
        <div class="cycling-club">
            Brooklyn's Premier Cycling Community
        </div>
    </div>
    
    <!-- Call-to-Action Buttons -->
    <div class="cta-buttons">
        <a href="{% url 'users:register' %}" class="cta-btn cta-join">
            Join the Club
            <i class="fas fa-arrow-right ml-2"></i>
        </a>
        <a href="{% url 'events:list' %}" class="cta-btn cta-events">
            Upcoming Rides
            <i class="fas fa-bicycle ml-2"></i>
        </a>
    </div>
    
    <!-- Slide Indicators -->
    <div class="slide-indicators">
        {% for image in slideshow_images %}
            <div class="indicator {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.counter0 }}"></div>
        {% empty %}
            <!-- Default indicators -->
            <div class="indicator active" data-slide="0"></div>
            <div class="indicator" data-slide="1"></div>
            <div class="indicator" data-slide="2"></div>
            <div class="indicator" data-slide="3"></div>
            <div class="indicator" data-slide="4"></div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // CYBLIME Slideshow JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const slides = document.querySelectorAll('.slide');
        const indicators = document.querySelectorAll('.indicator');
        let currentSlide = 0;
        let slideInterval;
        
        function showSlide(index) {
            // Hide all slides
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));
            
            // Show current slide
            if (slides[index]) {
                slides[index].classList.add('active');
                indicators[index].classList.add('active');
            }
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }
        
        function startSlideshow() {
            slideInterval = setInterval(nextSlide, 5000); // Change slide every 5 seconds
        }
        
        function stopSlideshow() {
            clearInterval(slideInterval);
        }
        
        // Initialize slideshow
        if (slides.length > 1) {
            startSlideshow();
        }
        
        // Handle indicator clicks
        indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', function() {
                stopSlideshow();
                currentSlide = index;
                showSlide(currentSlide);
                setTimeout(startSlideshow, 3000); // Restart after 3 seconds
            });
        });
        
        // Pause slideshow on hover
        const slideshowContainer = document.querySelector('.cyblime-slideshow');
        slideshowContainer.addEventListener('mouseenter', stopSlideshow);
        slideshowContainer.addEventListener('mouseleave', startSlideshow);
        
        // Touch/Swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;
        
        slideshowContainer.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        slideshowContainer.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                stopSlideshow();
                
                if (diff > 0) {
                    // Swipe left - next slide
                    nextSlide();
                } else {
                    // Swipe right - previous slide
                    currentSlide = currentSlide > 0 ? currentSlide - 1 : slides.length - 1;
                    showSlide(currentSlide);
                }
                
                setTimeout(startSlideshow, 3000);
            }
        }
    });
</script>
{% endblock %}
